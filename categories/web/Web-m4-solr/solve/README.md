## ะะปะพะณ

| ะกะพะฑััะธะต | ะะฐะทะฒะฐะฝะธะต | ะะฐัะตะณะพัะธั | ะกะปะพะถะฝะพััั |
|:--------|:---------|:----------|----------:|
| VKA-CTF`2020 | ะะปะพะณ | Web | 1-3 ะบััั |

### ะะฟะธัะฐะฝะธะต
> ะะฒัะพั: [ ๐๐ฃ๐๐ฆ๐ค๐ ]
>
> ะะพะตะฝะฝะพัะปัะถะฐัะธะผ ะฟะพ ััะฐัััั ะธั ัะปัะถะฑั ะฝะต ัะตะบะพะผะตะฝะดัะตััั ัะพะทะดะฐะฒะฐัั ัััะฐะฝะธัั ะฒ ัะพััะตััั, ะฒะตััะธ ะฑะปะพะณะธ ะธ ะฒัะบะปะฐะดัะฒะฐัั ะบะฐะบัั-ะปะธะฑะพ ะธะฝัะพัะผะฐัะธั ะพ ัะตะฑะต. ะั ะฟะพะฟััะฐะปะธัั ะฝะฐะนัะธ ะฒััะพะด ะธะท ะฟะพะปะพะถะตะฝะธั ะธ ัะพะทะดะฐะปะธ ัะฒะพะน [ัะตัะฒะธั](https://blog.vkactf.tk/).

### ะะตัะตะฝะธะต

![](./imgs/1.PNG)

ะะฐ ัััะฐะฝะธัั ะฒัะพะดะฐ ะฝะต ัะฐะฑะพัะฐัั ัะฐะทะปะธัะฝัะต ะพะฑัะพะดั ะฐะฒัะพัะธะทะฐัะธะธ. ะััััะพััะพะผ ะดะธัะตะบัะพัะธะน ะฝะฐ `/solr/` ะฝะฐัะพะดะธะผ ัะตัะฒะธั [Apache Solr](https://lucene.apache.org/solr/)

ะะตััะธั ะฟัะธะปะพะถะตะฝะธั ััะทะฒะธะผะฐ ะบ RCE ([CVE-2019-17558](https://nvd.nist.gov/vuln/detail/CVE-2019-17558)). 
ะัะฟะพะปัะทัะตะผ `metasploit` ะดะปั ะตะณะพ ัะตะฐะปะธะทะฐัะธะธ.

ะะฐ ัะตัะฒะตัะต ะดะฐะฝะฝัะต "ัะดะตั" ััะฐะฝัััั ะฟะพ `/var/solr/data/`. ะะธะดะธะผ ัะฐะผ core `users-passwords`, ะบะพัะพัะพะณะพ ะฝะตั ะฝะฐ web ะผะพัะดะต, ะธ ะตะณะพ ะดะฐะฝะฝัะต ะฟะพ `/var/solr/data/users-passwords/data/index`
```bash
> cat cat _0.fdt
?๏ฟฝlLucene50StoredFieldsFastData>G%๏ฟฝ๏ฟฝ@3๏ฟฝ{๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ978-064172344danield41i3l_p4ssw0rd)๏ฟฝ142310334richardmySecurePass123*๏ฟฝ85799587*๏ฟฝardojASokdad30sdASD*๏ฟฝ93398817MT๏ฟฝelonion-pepper-salt๏ฟฝ(๏ฟฝ๏ฟฝ๏ฟฝl
```
ะะธะดะธะผ ะบะฐะบ ะผะธะฝะธะผัะผ ะบัะตะดั ะพะดะฝะพะณะพ ะฟะพะปัะทะพะฒะฐัะตะปั `daniel:d41i3l_p4ssw0rd`. ะัะฟะพะปัะทัะตะผ ะธั, ััะพะฑั ะฐะฒัะพัะธะทะพะฒะฐัััั

ะัะธ ะฟัะพัะผะพััะต ะฟะพััะพะฒ ะดััะณะธั ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะฒ URI ะผะพะถะฝะพ ะทะฐะผะตัะธัั ััะทะฒะธะผัั ะบ `IDOR` ัััะพะบั `/user/<num>`. ะัะฟะพะปัะทัั ััะพ, ะทะฐะผะตัะฐะตะผ, ััะพ ะดะพัััะฟ ะบ `/user/1` ะทะฐะฟัะตััะฝ.

ะัะพะฑัั ะฒะฒะตััะธ ะฒะผะตััะพ ัะธัั ะฑัะบะฒั, ะฟะพะปััะฐะตะผ ะพัะธะฑะบั, ะฒ ัะตะทัะปััะฐัะต ะบะพัะพัะพะน ะฟะพัะฒะปัะตััั debug-mode ัััะฐะฝะธัะฐ. ะะพะปะธัะตััะฒะฐ ัััะพะบ ะบะพะดะฐ ะฟัะธะปะพะถะตะฝะธั, ะบะพัะพััะต ะผั ะฒะธะดะธะผ ะฒ ัะตะทัะปััะฐัะต ะดะฐะฝะฝะพะน ะพัะธะฑะบะธ, ะดะพััะฐัะพัะฝะพ, ััะพะฑั ะฟะพะปััะธัั ัะตะบัะตัะฝัะน ะบะปัั ะฟัะธะปะพะถะตะฝะธั.

ะัะฟะพะปัะทัะตะผ ะตะณะพ, ััะพะฑั ัะณะตะฝะตัะธัะพะฒะฐัั `cookie` ะฟะพะปัะทะพะฒะฐัะตะปั `admin` ะธ ะฟะพัะผะพััะตัั ะตะณะพ ะฟะพััั.

**ะคะปะฐะณ:**

> vka{d3bu6_m0d3_c4n_pl4y_4_b4d_j0k3}