## Ð¥Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ Ñ„Ð»Ð°Ð³Ð¾Ð²

| Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ðµ | ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ | ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ | Ð¡Ð»Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ |
|:--------|:---------|:----------|----------:|
| VKA-CTF`2020 | Ð¥Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ Ñ„Ð»Ð°Ð³Ð¾Ð² | Web | ÐÐ‘Ð˜Ð¢Ð£Ð Ð |

### ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ
> ÐÐ²Ñ‚Ð¾Ñ€: [ ð•‚ð•£ð•’ð•¦ð•¤ð•– ]
>
> ÐÐ°ÑˆÐ° Ñ€Ð°Ð·Ð²ÐµÐ´ÐºÐ° Ð½Ð°ÑˆÐ»Ð° Ð¿Ð¾Ð´Ð¾Ð·Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ [ÑÐ°Ð¹Ñ‚](https://flag-store.vkactf.tk) Ð¾Ð´Ð½Ð¾Ð¹ ÐºÑ€ÑƒÐ¿Ð½Ð¾Ð¹ Ð²Ð¾ÐµÐ½Ð½Ð¾Ð¹ Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¿Ñ€ÐµÐ´Ð¿Ð¾Ð»Ð°Ð³Ð°ÐµÐ¼Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾Ñ‚Ð¸Ð²Ð½Ð¸ÐºÐ°. ÐÐ°Ð¼ ÐºÐ°Ð¶ÐµÑ‚ÑÑ, Ñ‡Ñ‚Ð¾ Ð¾Ð½ Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ Ñ‚Ð¾, Ñ‡Ñ‚Ð¾ Ð½Ð°Ð¼ Ð½ÑƒÐ¶Ð½Ð¾. ÐŸÐ¾Ð¼Ð¾Ð³Ð¸Ñ‚Ðµ ÑƒÐ·Ð½Ð°Ñ‚ÑŒ ÑÐµÐºÑ€ÐµÑ‚Ñ‹ **Ð²Ð»Ð°Ð´ÐµÐ»ÑŒÑ†Ð° ÑÐ°Ð¹Ñ‚Ð°**.

### Ð ÐµÑˆÐµÐ½Ð¸Ðµ
![](imgs/1.PNG)
ÐŸÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ð¼ Ð½Ð° ÑÐ°Ð¹Ñ‚ Ð¸ Ð²Ð¸Ð´Ð¸Ð¼ Ñ„Ð¾Ñ€Ð¼Ñƒ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸. ÐŸÑ€Ð¾Ð±ÑƒÐµÐ¼ Ð²ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ ÐºÐ°Ð²Ñ‹Ñ‡ÐºÑƒ Ð¸ Ð²Ð¸Ð´Ð¸Ð¼ Ð¾ÑˆÐ¸Ð±ÐºÑƒ:
```
Warning: SimpleXMLElement::xpath(): Invalid predicate in /var/www/html/index.php on line 42
```
ÐŸÐ¾Ð½Ð¸Ð¼Ð°ÐµÐ¼, Ñ‡Ñ‚Ð¾ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ [XPath](https://ru.wikipedia.org/wiki/XPath).
Ð—Ð°Ð¹Ð´Ñ Ð² Ð¸ÑÑ…Ð¾Ð´Ð½Ñ‹Ð¹ ÐºÐ¾Ð´ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹, Ð½Ð°Ñ…Ð¾Ð´Ð¸Ð¼ [ÑÑÑ‹Ð»ÐºÑƒ](/index.php/src/) Ð½Ð° Ð¸ÑÑ…Ð¾Ð´Ð½Ð¸ÐºÐ¸ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ.
Ð’Ð¸Ð´Ð¸Ð¼, Ñ‡Ñ‚Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ð¹ Ð²Ð²Ð¾Ð´ Ñ‡ÐµÑ€ÐµÐ· Ð¿Ð¾Ð»Ñ **login** Ð¸ **password** Ñ„Ð¸Ð»ÑŒÑ‚Ñ€ÑƒÐµÑ‚ÑÑ:
```php
$blacklist = Array('or','0', '1', '2', '3', '4', '5', '6', '7', '8', '9');
``` 
Ð¢Ð°ÐºÐ¶Ðµ, Ð½Ð°ÑŽÐ±Ð»ÑŽÐ´Ð°ÐµÐ¼ Ð¾Ñ‡ÐµÐ½ÑŒ ÑÑ‚Ñ€Ð°Ð½Ð½ÑƒÑŽ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÑƒ Ð²ÐµÑ€Ð½Ð¾ÑÑ‚Ð¸ Ð²Ð²ÐµÐ´Ñ‘Ð½Ð½Ñ‹Ñ… Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ñ…
```php
$query = "//users/user[login/text()='$login' and password/text()='$pass']";

$result = $xml->xpath($query);
if(!$result){
    echo "ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ðµ Ð»Ð¾Ð³Ð¸Ð½ Ð¸Ð»Ð¸ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ";
}
else{
    $user_data = $xml->xpath("//users/user[login/text()='$login']")[0];
    $flag = $user_data->flag;
    echo "Ð¢Ð²Ð¾Ð¹ Ñ„Ð»Ð°Ð³: ".$flag;
}
```
Ð’Ð¸Ð´Ð¸Ð¼, Ñ‡Ñ‚Ð¾ Ð½Ð°Ð¼ Ð½ÑƒÐ¶Ð½Ð¾ Ð¿Ñ€Ð¾Ð²ÐµÑÑ‚Ð¸ Ð¸Ð½ÑŠÐµÐºÑ†Ð¸ÑŽ Ð² Ð¿Ð¾Ð»Ðµ **password** Ñ‚Ð°Ðº, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð±Ñ‹Ð» Ð²ÐµÑ€Ð½Ñ‹Ð¼ Ð¸ Ð²Ñ‹Ð´Ð°Ð» Ñ…Ð¾Ñ‚Ñ Ð±Ñ‹ Ð¾Ð´Ð¸Ð½ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚, Ð° Ð² Ð¿Ð¾Ð»Ðµ **login** Ð²Ð²ÐµÑÑ‚Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾Ð³Ð¾ Ð½Ð°Ð¼ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ (Ð¸Ð· Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ñ Ð·Ð°Ð´Ð°Ð½Ð¸Ñ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ð¾Ð½ÑÑ‚ÑŒ, Ñ‡Ñ‚Ð¾ Ð½Ð°Ð¼ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼ **admin**).

Ð£Ñ‡Ð¸Ñ‚Ñ‹Ð²Ð°Ñ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹, Ð¿Ñ€Ð¾ÑÑ‚ÐµÐ¹ÑˆÐ°Ñ Ð¸Ð½ÑŠÐµÐºÑ†Ð¸Ñ:
```
'] | //* | /foo[bar='
```

**Ð¤Ð»Ð°Ð³:**

> vka{51mpl3_xp47h_vuln3r4b1l17y}